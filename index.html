<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CONCESSIONNAIRE | IMPACT LIFE VEHICLES</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js/dist/umd/supabase.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        :root {
            --neon-red: #ff0040;
            --neon-red-glow: 0 0 15px #ff0000, 0 0 30px #ff0040, 0 0 45px #ffffff;
            --dark-bg: #000000;
            --darker-bg: #000000;
            --card-bg: rgba(10, 10, 10, 0.9);
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --accent-glow: rgba(255, 0, 64, 0.4);
            --scanline: rgba(255, 0, 64, 0.1);
            --gradient-red: linear-gradient(45deg, #ff0040, #ff3366, #ff0040);
        }
        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            font-family: 'Share Tech Mono', monospace;
            overflow-x: hidden;
            position: relative;
            line-height: 1.4;
        }
        /* Matrix Rain Effect */
        canvas#matrix-rain {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            opacity: 0.1;
        }
        /* CRT Monitor Effect */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 2px,
                var(--scanline) 2px,
                var(--scanline) 4px
            );
            pointer-events: none;
            z-index: 10000;
            opacity: 0.25;
            animation: scan 6s linear infinite;
        }
        @keyframes scan {
            0% { background-position: 0 0; }
            100% { background-position: 0 100vh; }
        }
        /* Glitch Effect Styles */
        .glitch {
            position: relative;
            display: inline-block;
            font-family: 'Orbitron', sans-serif;
        }
        .glitch::before,
        .glitch::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        .glitch::before {
            left: 2px;
            text-shadow: -2px 0 var(--neon-red);
            clip: rect(44px, 450px, 56px, 0);
            animation: glitch-anim 5s infinite linear alternate-reverse;
        }
        .glitch::after {
            left: -2px;
            text-shadow: -2px 0 #00ffff;
            clip: rect(44px, 450px, 56px, 0);
            animation: glitch-anim2 5s infinite linear alternate-reverse;
        }
        @keyframes glitch-anim {
            0% { clip: rect(42px, 9999px, 44px, 0); }
            5% { clip: rect(12px, 9999px, 59px, 0); }
            10% { clip: rect(48px, 9999px, 29px, 0); }
            15% { clip: rect(42px, 9999px, 73px, 0); }
            20% { clip: rect(63px, 9999px, 27px, 0); }
            25% { clip: rect(34px, 9999px, 55px, 0); }
            30% { clip: rect(86px, 9999px, 73px, 0); }
            35% { clip: rect(20px, 9999px, 20px, 0); }
            40% { clip: rect(26px, 9999px, 60px, 0); }
            45% { clip: rect(25px, 9999px, 66px, 0); }
            50% { clip: rect(57px, 9999px, 98px, 0); }
            55% { clip: rect(5px, 9999px, 46px, 0); }
            60% { clip: rect(82px, 9999px, 31px, 0); }
            65% { clip: rect(54px, 9999px, 27px, 0); }
            70% { clip: rect(28px, 9999px, 99px, 0); }
            75% { clip: rect(45px, 9999px, 69px, 0); }
            80% { clip: rect(23px, 9999px, 85px, 0); }
            85% { clip: rect(1px, 9999px, 72px, 0); }
            90% { clip: rect(74px, 9999px, 34px, 0); }
            95% { clip: rect(72px, 9999px, 59px, 0); }
            100% { clip: rect(42px, 9999px, 44px, 0); }
        }
        @keyframes glitch-anim2 {
            0% { clip: rect(65px, 9999px, 100px, 0); }
            5% { clip: rect(52px, 9999px, 74px, 0); }
            10% { clip: rect(79px, 9999px, 85px, 0); }
            15% { clip: rect(75px, 9999px, 5px, 0); }
            20% { clip: rect(67px, 9999px, 61px, 0); }
            25% { clip: rect(14px, 9999px, 79px, 0); }
            30% { clip: rect(1px, 9999px, 66px, 0); }
            35% { clip: rect(86px, 9999px, 30px, 0); }
            40% { clip: rect(23px, 9999px, 98px, 0); }
            45% { clip: rect(85px, 9999px, 72px, 0); }
            50% { clip: rect(71px, 9999px, 75px, 0); }
            55% { clip: rect(2px, 9999px, 48px, 0); }
            60% { clip: rect(30px, 9999px, 16px, 0); }
            65% { clip: rect(59px, 9999px, 50px, 0); }
            70% { clip: rect(41px, 9999px, 62px, 0); }
            75% { clip: rect(2px, 9999px, 82px, 0); }
            80% { clip: rect(47px, 9999px, 73px, 0); }
            85% { clip: rect(3px, 9999px, 27px, 0); }
            90% { clip: rect(56px, 9999px, 59px, 0); }
            95% { clip: rect(45px, 9999px, 47px, 0); }
            100% { clip: rect(65px, 9999px, 100px, 0); }
        }
        /* Glitch Hover Effect */
        .glitch-hover {
            position: relative;
            transition: all 0.3s ease;
            font-family: 'Share Tech Mono', monospace;
        }
        .glitch-hover:hover {
            animation: glitch-hover 0.5s ease-in-out;
        }
        @keyframes glitch-hover {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-3px); }
            40% { transform: translateX(3px); }
            60% { transform: translateX(-2px); }
            80% { transform: translateX(2px); }
        }
        /* Header */
        header {
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(5px);
            border-bottom: 2px solid var(--neon-red);
            padding: 1rem 2rem;
            box-shadow: 0 0 20px var(--accent-glow);
        }
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1600px;
            margin: 0 auto;
        }
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .logo-icon {
            font-size: 2.2rem;
            color: var(--neon-red);
            text-shadow: var(--neon-red-glow);
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .logo-text {
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem;
            font-weight: 800;
            letter-spacing: 3px;
            text-transform: uppercase;
        }
        .nav-menu {
            display: flex;
            gap: 2.5rem;
            list-style: none;
        }
        .nav-link {
            color: var(--text-primary);
            text-decoration: none;
            font-size: 1.2rem;
            font-weight: 600;
            position: relative;
            padding: 8px 0;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        .nav-link:hover {
            color: var(--neon-red);
            text-shadow: var(--neon-red-glow);
        }
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 1.8rem;
            cursor: pointer;
        }
        /* Hero Section */
        .hero {
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            margin-top: 80px;
            overflow: hidden;
            background:
                radial-gradient(circle at 20% 30%, rgba(255, 0, 64, 0.05) 0%, transparent 40%),
                radial-gradient(circle at 80% 70%, rgba(255, 0, 64, 0.05) 0%, transparent 40%);
        }
        .hero-content {
            text-align: center;
            max-width: 900px;
            padding: 2rem;
            position: relative;
            z-index: 2;
        }
        .hero h1 {
            font-size: 5.5rem;
            margin-bottom: 1.5rem;
            line-height: 1.1;
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        .hero-subtitle {
            font-size: 1.4rem;
            color: var(--text-secondary);
            margin-bottom: 2.5rem;
            line-height: 1.6;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            font-family: 'Share Tech Mono', monospace;
        }
        .hero-stats {
            display: flex;
            justify-content: center;
            gap: 4rem;
            margin-bottom: 2.5rem;
            font-family: 'Orbitron', sans-serif;
        }
        .stat-item {
            text-align: center;
        }
        .stat-number {
            font-size: 2.8rem;
            color: var(--neon-red);
            margin-bottom: 0.5rem;
            text-shadow: var(--neon-red-glow);
        }
        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 3px;
            font-family: 'Share Tech Mono', monospace;
        }
        .cta-button {
            background: transparent;
            color: var(--neon-red);
            border: 3px solid var(--neon-red);
            padding: 18px 45px;
            font-size: 1.2rem;
            font-weight: 700;
            font-family: 'Orbitron', sans-serif;
            cursor: pointer;
            transition: all 0.4s ease;
            text-transform: uppercase;
            letter-spacing: 4px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 20px var(--accent-glow);
        }
        .cta-button:hover {
            background: var(--neon-red);
            color: var(--dark-bg);
            transform: translateY(-5px);
            box-shadow: 0 0 30px var(--accent-glow);
        }
        /* Categories Section - Hexagonal Grid Layout */
        .categories-section {
            padding: 5rem 2rem 4rem;
            position: relative;
            background: var(--darker-bg);
        }
        .section-header {
            text-align: center;
            margin-bottom: 3rem;
            position: relative;
        }
        .section-title {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            position: relative;
            display: inline-block;
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        .section-title::after {
            content: '';
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 3px;
            background: var(--neon-red);
            box-shadow: 0 0 20px var(--neon-red);
        }
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 2.5rem;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }
        .category-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 2.5rem 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            border: 3px solid transparent;
            box-shadow: 0 10px 35px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(12px);
            font-family: 'Share Tech Mono', monospace;
        }
        .category-card.active {
            border: 3px solid var(--neon-red);
            box-shadow: 0 0 40px var(--accent-glow), 0 15px 45px rgba(0, 0, 0, 0.6);
            transform: scale(1.1);
        }
        .category-card:hover {
            transform: translateY(-12px) scale(1.08);
            border: 3px solid var(--neon-red);
            box-shadow: 0 20px 50px var(--accent-glow), 0 15px 45px rgba(0, 0, 0, 0.6);
        }
        .category-icon {
            font-size: 3rem;
            margin-bottom: 1.5rem;
            color: var(--neon-red);
            transition: all 0.4s ease;
            text-shadow: 0 0 20px rgba(255, 0, 64, 0.6);
        }
        .category-card:hover .category-icon {
            transform: scale(1.4) rotate(20deg);
            text-shadow: 0 0 35px rgba(255, 0, 64, 0.9);
        }
        .category-title {
            font-size: 1.4rem;
            margin-bottom: 1rem;
            color: var(--neon-red);
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 2px;
            text-transform: uppercase;
            text-shadow: var(--neon-red-glow);
            font-weight: 700;
        }
        .category-description {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 1.2rem;
            font-family: 'Share Tech Mono', monospace;
            min-height: 60px;
        }
        .category-count {
            display: inline-block;
            background: var(--gradient-red);
            color: var(--dark-bg);
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 0.95rem;
            font-weight: 700;
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            letter-spacing: 2px;
            box-shadow: 0 0 15px var(--accent-glow);
            border: 2px solid var(--neon-red);
        }
        /* Vehicles Showcase */
        .vehicles-showcase {
            padding: 4rem 2rem 5rem;
            background: var(--darker-bg);
            position: relative;
            border-top: 2px solid rgba(255, 0, 64, 0.3);
            border-bottom: 2px solid rgba(255, 0, 64, 0.3);
        }
        .vehicles-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2.5rem;
            flex-wrap: wrap;
            gap: 1rem;
            padding: 0 2rem;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
        }
        .current-category {
            font-size: 1.8rem;
            color: var(--neon-red);
            font-family: 'Orbitron', sans-serif;
            text-shadow: var(--neon-red-glow);
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        .add-vehicle-btn {
            background: var(--gradient-red);
            color: var(--dark-bg);
            border: none;
            padding: 14px 28px;
            font-size: 1.1rem;
            font-weight: 700;
            font-family: 'Orbitron', sans-serif;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 2px;
            box-shadow: 0 0 20px var(--accent-glow);
            border-radius: 10px;
            position: relative;
            overflow: hidden;
        }
        .add-vehicle-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }
        .add-vehicle-btn:hover::before {
            left: 100%;
        }
        .add-vehicle-btn:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: 0 0 30px var(--accent-glow);
        }
        .vehicles-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2.5rem;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }
        .vehicle-card {
            background: var(--card-bg);
            border-radius: 15px;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            border: 2px solid transparent;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
        }
        .vehicle-card:hover {
            transform: translateY(-12px);
            border: 2px solid var(--neon-red);
            box-shadow: 0 25px 60px var(--accent-glow), 0 15px 40px rgba(0, 0, 0, 0.6);
        }
        .vehicle-image-container {
            height: 240px;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            border-bottom: 3px solid var(--neon-red);
        }
        .vehicle-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .vehicle-card:hover .vehicle-image {
            transform: scale(1.15);
        }
        .vehicle-info {
            padding: 2rem;
            font-family: 'Share Tech Mono', monospace;
        }
        .vehicle-name {
            font-size: 1.7rem;
            margin-bottom: 1.1rem;
            color: var(--neon-red);
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 1px;
            text-transform: uppercase;
            text-shadow: var(--neon-red-glow);
            font-weight: 700;
        }
        .vehicle-price {
            font-size: 1.9rem;
            font-weight: 800;
            margin-bottom: 1.3rem;
            background: linear-gradient(45deg, #ffffff, #ff6b9d);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-family: 'Orbitron', sans-serif;
        }
        .vehicle-specs {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1.6rem;
            color: var(--text-secondary);
            font-size: 0.98rem;
            font-family: 'Share Tech Mono', monospace;
        }
        .spec-item {
            text-align: center;
            flex: 1;
        }
        .spec-value {
            display: block;
            font-weight: 800;
            color: var(--neon-red);
            font-size: 1.2rem;
            font-family: 'Orbitron', sans-serif;
            text-shadow: var(--neon-red-glow);
        }
        .vehicle-actions {
            display: flex;
            gap: 15px;
        }
        .action-btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Share Tech Mono', monospace;
            font-size: 1.05rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }
        .btn-buy {
            background: var(--gradient-red);
            color: var(--dark-bg);
            box-shadow: 0 0 20px var(--accent-glow);
        }
        .btn-details {
            background: transparent;
            color: var(--neon-red);
            border: 2px solid var(--neon-red);
            box-shadow: 0 0 20px rgba(255, 0, 64, 0.4);
        }
        .action-btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px var(--accent-glow);
        }
        /* Add Vehicle Modal - Compact */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.96);
            z-index: 2000;
            backdrop-filter: blur(8px);
            animation: modal-fade-in 0.4s ease;
        }
        @keyframes modal-fade-in {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }
        .modal-content {
            background: var(--card-bg);
            border: 3px solid var(--neon-red);
            border-radius: 16px;
            width: 90%;
            max-width: 550px;
            margin: 2rem auto;
            padding: 2.2rem;
            position: relative;
            box-shadow: 0 0 50px var(--accent-glow);
            font-family: 'Share Tech Mono', monospace;
            backdrop-filter: blur(12px);
            max-height: 80vh;
            overflow-y: auto;
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.8rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid var(--neon-red);
        }
        .modal-title {
            font-size: 1.9rem;
            color: var(--neon-red);
            font-family: 'Orbitron', sans-serif;
            text-shadow: var(--neon-red-glow);
            letter-spacing: 1.5px;
            text-transform: uppercase;
        }
        .close-modal {
            background: linear-gradient(45deg, var(--neon-red), #ff3366);
            border: 2px solid var(--neon-red);
            color: var(--dark-bg);
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 38px;
            height: 38px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Orbitron', sans-serif;
            border-radius: 50%;
            box-shadow: 0 0 16px var(--accent-glow);
        }
        .close-modal:hover {
            transform: rotate(180deg) scale(1.15);
            box-shadow: 0 0 25px var(--accent-glow);
        }
        .form-group {
            margin-bottom: 1.4rem;
        }
        .form-label {
            display: block;
            margin-bottom: 0.8rem;
            color: var(--neon-red);
            font-weight: 700;
            font-family: 'Orbitron', sans-serif;
            font-size: 1.05rem;
            letter-spacing: 1.5px;
            text-transform: uppercase;
        }
        .form-input,
        .form-select {
            width: 100%;
            padding: 12px 15px;
            background: rgba(20, 20, 20, 0.92);
            border: 2px solid var(--neon-red);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.95rem;
            font-family: 'Share Tech Mono', monospace;
            transition: all 0.3s ease;
        }
        .form-input:focus,
        .form-select:focus {
            outline: none;
            box-shadow: 0 0 20px var(--accent-glow);
            border-color: #ff3366;
        }
        .form-input::placeholder {
            color: #777;
            font-family: 'Share Tech Mono', monospace;
        }
        .submit-btn {
            width: 100%;
            padding: 14px;
            background: var(--gradient-red);
            color: var(--dark-bg);
            border: 2px solid var(--neon-red);
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 800;
            font-family: 'Orbitron', sans-serif;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: all 0.3s ease;
            box-shadow: 0 0 20px var(--accent-glow);
            position: relative;
            overflow: hidden;
            font-size: 1rem;
        }
        .submit-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }
        .submit-btn:hover::before {
            left: 100%;
        }
        .submit-btn:hover {
            transform: translateY(-4px) scale(1.04);
            box-shadow: 0 0 30px var(--accent-glow);
        }
        /* Vehicle Details Modal - Compact */
        .details-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.96);
            z-index: 3000;
            backdrop-filter: blur(8px);
        }
        .details-content {
            background: var(--card-bg);
            border: 3px solid var(--neon-red);
            border-radius: 16px;
            width: 90%;
            max-width: 650px;
            margin: 2rem auto;
            padding: 2.2rem;
            position: relative;
            box-shadow: 0 0 50px var(--accent-glow);
            font-family: 'Share Tech Mono', monospace;
            backdrop-filter: blur(12px);
            max-height: 85vh;
            overflow-y: auto;
        }
        .details-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.8rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid var(--neon-red);
        }
        .details-title {
            font-size: 2.1rem;
            color: var(--neon-red);
            font-family: 'Orbitron', sans-serif;
            text-shadow: var(--neon-red-glow);
            letter-spacing: 1.5px;
            text-transform: uppercase;
        }
        .details-image-container {
            height: 280px;
            margin-bottom: 2rem;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.5);
            border: 2px solid var(--neon-red);
            position: relative;
        }
        .details-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .details-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 1.8rem;
            margin-bottom: 2rem;
        }
        .detail-item {
            text-align: center;
            padding: 1.2rem;
            border: 1px solid var(--neon-red);
            background: rgba(25, 25, 25, 0.8);
            border-radius: 10px;
            transition: all 0.3s ease;
        }
        .detail-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px var(--accent-glow);
            border-color: #ff3366;
        }
        .detail-label {
            color: var(--text-secondary);
            font-size: 0.95rem;
            margin-bottom: 0.8rem;
            font-family: 'Share Tech Mono', monospace;
            letter-spacing: 1px;
        }
        .detail-value {
            font-size: 1.6rem;
            font-weight: 800;
            color: var(--neon-red);
            font-family: 'Orbitron', sans-serif;
            text-shadow: var(--neon-red-glow);
            letter-spacing: 1px;
        }
        .details-actions {
            display: flex;
            gap: 16px;
            justify-content: center;
        }
        /* Panier */
        .cart-icon {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: var(--gradient-red);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--dark-bg);
            font-size: 1.8rem;
            cursor: pointer;
            z-index: 1001;
            box-shadow: 0 0 20px var(--accent-glow);
            transition: all 0.3s ease;
            border: 3px solid var(--neon-red);
        }
        .cart-icon:hover {
            transform: scale(1.1);
            box-shadow: 0 0 30px var(--accent-glow);
        }
        .cart-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--neon-red);
            color: var(--dark-bg);
            border-radius: 50%;
            width: 26px;
            height: 26px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            font-weight: bold;
            font-family: 'Orbitron', sans-serif;
        }
        .cart-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.96);
            z-index: 4000;
            backdrop-filter: blur(8px);
            animation: modal-fade-in 0.4s ease;
        }
        .cart-content {
            background: var(--card-bg);
            border: 3px solid var(--neon-red);
            border-radius: 16px;
            width: 90%;
            max-width: 700px;
            margin: 5rem auto;
            padding: 2.2rem;
            position: relative;
            box-shadow: 0 0 50px var(--accent-glow);
            font-family: 'Share Tech Mono', monospace;
            backdrop-filter: blur(12px);
            max-height: 70vh;
            overflow-y: auto;
        }
        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.8rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid var(--neon-red);
        }
        .cart-title {
            font-size: 1.9rem;
            color: var(--neon-red);
            font-family: 'Orbitron', sans-serif;
            text-shadow: var(--neon-red-glow);
            letter-spacing: 1.5px;
            text-transform: uppercase;
        }
        .cart-items {
            margin-bottom: 2rem;
            max-height: 40vh;
            overflow-y: auto;
            padding-right: 5px;
        }
        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid rgba(255, 0, 64, 0.2);
            margin-bottom: 1rem;
            background: rgba(20, 20, 20, 0.6);
            border-radius: 8px;
            padding-left: 1rem;
            padding-right: 1rem;
        }
        .cart-item-info {
            flex: 1;
        }
        .cart-item-name {
            font-size: 1.2rem;
            color: var(--neon-red);
            font-weight: bold;
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 1px;
        }
        .cart-item-price {
            font-size: 1.1rem;
            color: var(--text-secondary);
            margin-top: 0.3rem;
        }
        .cart-item-quantity {
            color: var(--text-secondary);
            font-size: 1rem;
            margin-top: 0.3rem;
        }
        .cart-item-remove {
            background: transparent;
            color: #ff3366;
            border: 2px solid #ff3366;
            border-radius: 5px;
            padding: 8px 12px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.9rem;
        }
        .cart-item-remove:hover {
            background: #ff3366;
            color: var(--dark-bg);
            transform: scale(1.05);
        }
        .cart-total {
            font-size: 1.6rem;
            font-weight: bold;
            text-align: right;
            margin-bottom: 1.5rem;
            color: var(--neon-red);
            font-family: 'Orbitron', sans-serif;
            padding-top: 1rem;
            border-top: 2px solid var(--neon-red);
        }
        .cart-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
        }
        .cart-btn {
            padding: 14px 24px;
            border: 2px solid var(--neon-red);
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Share Tech Mono', monospace;
            font-size: 1.05rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
            min-width: 150px;
        }
        .btn-clear {
            background: transparent;
            color: var(--neon-red);
        }
        .btn-clear:hover {
            background: var(--neon-red);
            color: var(--dark-bg);
        }
        .cart-empty-message {
            text-align: center;
            color: var(--text-secondary);
            font-size: 1.1rem;
            padding: 2rem 0;
            font-style: italic;
        }
        /* Modal de Connexion Admin */
        .login-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.96);
            z-index: 5000;
            backdrop-filter: blur(8px);
            animation: modal-fade-in 0.4s ease;
        }
        .login-content {
            background: var(--card-bg);
            border: 3px solid var(--neon-red);
            border-radius: 16px;
            width: 90%;
            max-width: 400px;
            margin: 10rem auto;
            padding: 2.2rem;
            position: relative;
            box-shadow: 0 0 50px var(--accent-glow);
            font-family: 'Share Tech Mono', monospace;
            backdrop-filter: blur(12px);
        }
        .login-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.8rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid var(--neon-red);
        }
        .login-title {
            font-size: 1.9rem;
            color: var(--neon-red);
            font-family: 'Orbitron', sans-serif;
            text-shadow: var(--neon-red-glow);
            letter-spacing: 1.5px;
            text-transform: uppercase;
        }
        .login-form-group {
            margin-bottom: 1.4rem;
        }
        .login-label {
            display: block;
            margin-bottom: 0.8rem;
            color: var(--text-secondary);
            font-weight: 700;
            font-family: 'Orbitron', sans-serif;
            font-size: 1.05rem;
            letter-spacing: 1.5px;
            text-transform: uppercase;
        }
        .login-input {
            width: 100%;
            padding: 12px 15px;
            background: rgba(20, 20, 20, 0.92);
            border: 2px solid var(--neon-red);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.95rem;
            font-family: 'Share Tech Mono', monospace;
            transition: all 0.3s ease;
        }
        .login-input:focus {
            outline: none;
            box-shadow: 0 0 20px var(--accent-glow);
            border-color: #ff3366;
        }
        .login-btn {
            width: 100%;
            padding: 14px;
            background: var(--gradient-red);
            color: var(--dark-bg);
            border: 2px solid var(--neon-red);
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 800;
            font-family: 'Orbitron', sans-serif;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: all 0.3s ease;
            box-shadow: 0 0 20px var(--accent-glow);
            position: relative;
            overflow: hidden;
            font-size: 1rem;
        }
        .login-btn:hover {
            transform: translateY(-4px) scale(1.04);
            box-shadow: 0 0 30px var(--accent-glow);
        }
        /* Page de Service */
        .service-page {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.96);
            z-index: 6000;
            backdrop-filter: blur(8px);
            animation: modal-fade-in 0.4s ease;
        }
        .service-content {
            background: var(--card-bg);
            border: 3px solid var(--neon-red);
            border-radius: 16px;
            width: 90%;
            max-width: 700px;
            margin: 5rem auto;
            padding: 2.2rem;
            position: relative;
            box-shadow: 0 0 50px var(--accent-glow);
            font-family: 'Share Tech Mono', monospace;
            backdrop-filter: blur(12px);
            max-height: 70vh;
            overflow-y: auto;
        }
        .service-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.8rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid var(--neon-red);
        }
        .service-title {
            font-size: 1.9rem;
            color: var(--neon-red);
            font-family: 'Orbitron', sans-serif;
            text-shadow: var(--neon-red-glow);
            letter-spacing: 1.5px;
            text-transform: uppercase;
        }
        .service-controls {
            margin-bottom: 2rem;
        }
        .service-btn {
            width: 100%;
            padding: 14px;
            margin-bottom: 1rem;
            background: var(--gradient-red);
            color: var(--dark-bg);
            border: 2px solid var(--neon-red);
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 800;
            font-family: 'Orbitron', sans-serif;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: all 0.3s ease;
            box-shadow: 0 0 20px var(--accent-glow);
            position: relative;
            overflow: hidden;
            font-size: 1rem;
        }
        .service-btn:hover {
            transform: translateY(-4px) scale(1.04);
            box-shadow: 0 0 30px var(--accent-glow);
        }
        .timer-display {
            font-size: 1.8rem;
            text-align: center;
            margin: 1.5rem 0;
            color: var(--neon-red);
            font-family: 'Orbitron', sans-serif;
            text-shadow: var(--neon-red-glow);
            letter-spacing: 2px;
        }
        .sale-section {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 2px solid var(--neon-red);
        }
        .sale-title {
            font-size: 1.6rem;
            color: var(--neon-red);
            margin-bottom: 1.5rem;
            font-family: 'Orbitron', sans-serif;
        }
        .sale-search {
            width: 100%;
            padding: 12px 15px;
            background: rgba(20, 20, 20, 0.92);
            border: 2px solid var(--neon-red);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.95rem;
            font-family: 'Share Tech Mono', monospace;
            margin-bottom: 1rem;
        }
        .sale-input {
            width: 100%;
            padding: 12px 15px;
            background: rgba(20, 20, 20, 0.92);
            border: 2px solid var(--neon-red);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.95rem;
            font-family: 'Share Tech Mono', monospace;
            margin-bottom: 1rem;
        }
        .sale-btn {
            width: 100%;
            padding: 14px;
            background: var(--gradient-red);
            color: var(--dark-bg);
            border: 2px solid var(--neon-red);
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 800;
            font-family: 'Orbitron', sans-serif;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: all 0.3s ease;
            box-shadow: 0 0 20px var(--accent-glow);
            position: relative;
            overflow: hidden;
            font-size: 1rem;
        }
        .sale-btn:hover {
            transform: translateY(-4px) scale(1.04);
            box-shadow: 0 0 30px var(--accent-glow);
        }
        /* --- NOUVELLE MODALE DOSSIER --- */
        .dossier-page {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.96);
            z-index: 7000;
            backdrop-filter: blur(8px);
            animation: modal-fade-in 0.4s ease;
        }
        .dossier-content {
            background: var(--card-bg);
            border: 3px solid var(--neon-red);
            border-radius: 16px;
            width: 90%;
            max-width: 800px;
            margin: 3rem auto;
            padding: 2.2rem;
            position: relative;
            box-shadow: 0 0 50px var(--accent-glow);
            font-family: 'Share Tech Mono', monospace;
            backdrop-filter: blur(12px);
            max-height: 80vh;
            overflow-y: auto;
        }
        .dossier-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.8rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid var(--neon-red);
        }
        .dossier-title {
            font-size: 1.9rem;
            color: var(--neon-red);
            font-family: 'Orbitron', sans-serif;
            text-shadow: var(--neon-red-glow);
            letter-spacing: 1.5px;
            text-transform: uppercase;
        }
        .role-buttons {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        .role-btn {
            padding: 14px 28px;
            background: var(--gradient-red);
            color: var(--dark-bg);
            border: 2px solid var(--neon-red);
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 800;
            font-family: 'Orbitron', sans-serif;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: all 0.3s ease;
            box-shadow: 0 0 20px var(--accent-glow);
            position: relative;
            overflow: hidden;
            min-width: 150px;
        }
        .role-btn:hover {
            transform: translateY(-4px) scale(1.04);
            box-shadow: 0 0 30px var(--accent-glow);
        }
        .vendeurs-list {
            display: none;
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 2px solid var(--neon-red);
        }
        .vendeurs-title {
            text-align: center;
            font-size: 1.6rem;
            color: var(--neon-red);
            margin-bottom: 1.5rem;
            font-family: 'Orbitron', sans-serif;
        }
        .vendeurs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 1rem;
        }
        .vendeur-btn {
            padding: 12px;
            background: rgba(20, 20, 20, 0.9);
            color: var(--neon-red);
            border: 2px solid var(--neon-red);
            border-radius: 8px;
            font-family: 'Orbitron', sans-serif;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .vendeur-btn:hover {
            background: var(--neon-red);
            color: var(--dark-bg);
            transform: scale(1.05);
        }
        .summary-section {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 2px solid var(--neon-red);
        }
        .summary-title {
            font-size: 1.6rem;
            color: var(--neon-red);
            margin-bottom: 1.5rem;
            font-family: 'Orbitron', sans-serif;
            text-align: center;
        }
        .summary-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }
        .summary-box {
            background: rgba(20, 20, 20, 0.8);
            padding: 1.2rem;
            border-radius: 10px;
            border: 1px solid var(--neon-red);
        }
        .summary-label {
            color: var(--text-secondary);
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }
        .summary-value {
            font-size: 1.8rem;
            color: var(--neon-red);
            font-family: 'Orbitron', sans-serif;
            font-weight: 800;
        }
        .sales-list {
            margin-top: 1.5rem;
        }
        .sales-title {
            color: var(--neon-red);
            margin-bottom: 0.8rem;
            font-family: 'Orbitron', sans-serif;
        }
        .sale-item {
            padding: 0.6rem 0;
            border-bottom: 1px solid rgba(255,0,64,0.2);
            font-size: 1.1rem !important; /* ‚Üê agrandi */
            font-size: 0.95rem;
        }
        /* Footer */
        footer {
            background: var(--darker-bg);
            padding: 2.5rem 2rem 2rem;
            border-top: 2px solid var(--neon-red);
            position: relative;
        }
        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 2.5rem;
            font-family: 'Share Tech Mono', monospace;
            padding: 0 2rem;
        }
        .footer-column h3 {
            font-size: 1.4rem;
            margin-bottom: 1.5rem;
            color: var(--neon-red);
            position: relative;
            padding-bottom: 10px;
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        .footer-column h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 45px;
            height: 2px;
            background: var(--neon-red);
            box-shadow: 0 0 10px var(--accent-glow);
        }
        .footer-links {
            list-style: none;
        }
        .footer-links li {
            margin-bottom: 0.8rem;
        }
        .footer-links a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.95rem;
            letter-spacing: 1px;
        }
        .footer-links a:hover {
            color: var(--neon-red);
            transform: translateX(8px);
            text-shadow: var(--neon-red-glow);
        }
        .footer-links a i {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        .social-links {
            display: flex;
            gap: 18px;
            margin-top: 1.8rem;
        }
        .social-link {
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--neon-red);
            text-decoration: none;
            transition: all 0.3s ease;
            border: 2px solid var(--neon-red);
            border-radius: 50%;
            font-size: 1.1rem;
            background: transparent;
        }
        .social-link:hover {
            background: var(--neon-red);
            color: var(--dark-bg);
            transform: translateY(-5px) rotate(10deg);
            box-shadow: 0 0 20px var(--accent-glow);
        }
        /* --- Scroll Animation --- */
        .fade-in {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        
        .fade-in.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .copyright {
            text-align: center;
            padding-top: 2rem;
            color: var(--text-secondary);
            font-size: 0.9rem;
            border-top: 1px solid rgba(255, 0, 64, 0.3);
            margin-top: 2rem;
            font-family: 'Share Tech Mono', monospace;
            letter-spacing: 1px;
        }
        /* Responsive Design */
        @media (max-width: 1200px) {
            .categories-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 2rem;
            }
        }
        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: block;
            }
            .nav-menu {
                display: none;
                position: absolute;
                top: 80px;
                left: 0;
                width: 100%;
                background: rgba(0, 0, 0, 0.98);
                flex-direction: column;
                padding: 2.5rem;
                gap: 2rem;
                backdrop-filter: blur(5px);
                border-top: 2px solid var(--neon-red);
            }
            .nav-menu.show {
                display: flex;
            }
            .hero h1 {
                font-size: 3rem;
            }
            .hero-stats {
                gap: 2rem;
                flex-wrap: wrap;
            }
            .stat-number {
                font-size: 2rem;
            }
            .section-title {
                font-size: 2.5rem;
            }
            .categories-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 1.8rem;
                padding: 0 1.5rem;
            }
            .category-card {
                padding: 2rem 1.2rem;
            }
            .category-icon {
                font-size: 2.5rem;
            }
            .category-title {
                font-size: 1.2rem;
            }
            .vehicles-grid {
                grid-template-columns: 1fr;
                padding: 0 1.5rem;
                gap: 2rem;
            }
            .details-info {
                grid-template-columns: 1fr;
            }
            .details-image-container {
                height: 280px;
            }
            .cart-content {
                width: 95%;
                margin: 2rem auto;
                padding: 1.8rem;
            }
            .cart-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            .cart-item-remove {
                align-self: flex-end;
            }
            .cart-actions {
                flex-direction: column;
            }
            .cart-btn {
                width: 100%;
            }
            .login-content {
                width: 95%;
                margin: 8rem auto;
            }
            .service-content {
                width: 95%;
                margin: 3rem auto;
            }
            .dossier-content {
                width: 95%;
                margin: 2rem auto;
            }
            .role-buttons {
                flex-direction: column;
                align-items: center;
            }
            .summary-grid {
                grid-template-columns: 1fr;
            }
        }
        @media (max-width: 480px) {
            .hero h1 {
                font-size: 2.2rem;
            }
            .hero-subtitle {
                font-size: 1rem;
            }
            .section-title {
                font-size: 2rem;
            }
            .current-category {
                font-size: 1.5rem;
            }
            .categories-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
                padding: 0 1rem;
            }
            .category-card {
                padding: 1.8rem 1rem;
            }
            .category-icon {
                font-size: 2.2rem;
            }
            .category-title {
                font-size: 1.1rem;
            }
            .modal-content,
            .details-content {
                width: 95%;
                margin: 1rem auto;
                padding: 1.8rem;
            }
            .details-image-container {
                height: 220px;
            }
        }
    </style>
</head>
<body>
    <!-- Matrix Rain Canvas -->
    <canvas id="matrix-rain"></canvas>
    <!-- Bouton Panier -->
    <button class="cart-icon" id="cartIcon">
        <i class="fas fa-shopping-cart"></i>
        <span class="cart-badge" id="cartBadge">0</span>
    </button>
    <!-- Modal Panier -->
    <div class="cart-modal" id="cartModal">
        <div class="cart-content">
            <div class="cart-header">
                <h3 class="cart-title glitch" data-text="PANIER">PANIER</h3>
                <button class="close-modal" id="closeCartModal">&times;</button>
            </div>
            <div class="cart-items" id="cartItems">
                <div class="cart-empty-message" id="cartEmptyMessage">Votre panier est vide.</div>
            </div>
            <div class="cart-total" id="cartTotal">Total: ‚Ç¨0</div>
            <div class="cart-actions">
                <button class="cart-btn btn-clear glitch-hover" id="clearCartBtn">TOUT SUPPRIMER</button>
            </div>
        </div>
    </div>
    <!-- Modal de Connexion Admin -->
    <div class="login-modal" id="loginModal">
        <div class="login-content">
            <div class="login-header">
                <h3 class="login-title glitch" data-text="CONNEXION">CONNEXION</h3>
                <button class="close-modal" id="closeLoginModal">&times;</button>
            </div>
            <form id="loginForm">
                <div class="login-form-group">
                    <label class="login-label glitch" data-text="NOM D'UTILISATEUR">NOM D'UTILISATEUR</label>
                    <input type="text" id="adminUsername" class="login-input" placeholder="Entrez votre nom d'utilisateur" required>
                </div>
                <div class="login-form-group">
                    <label class="login-label glitch" data-text="MOT DE PASSE">MOT DE PASSE</label>
                    <input type="password" id="adminPassword" class="login-input" placeholder="Entrez votre mot de passe" required>
                </div>
                <button type="submit" class="login-btn glitch-hover">SE CONNECTER</button>
            </form>
        </div>
    </div>
    <!-- Page de Service -->
    <div class="service-page" id="servicePage">
        <div class="service-content">
            <div class="service-header">
                <h3 class="service-title glitch" data-text="PANEL DE SERVICE">PANEL DE SERVICE</h3>
                <button class="close-modal" id="closeServiceModal">&times;</button>
            </div>
            <div class="service-controls">
                <button class="service-btn glitch-hover" id="startServiceBtn">PRENDRE SON SERVICE</button>
                <button class="service-btn glitch-hover" id="pauseServiceBtn" style="display:none;">PAUSE</button>
                <button class="service-btn glitch-hover" id="resumeServiceBtn" style="display:none;">REPRENDRE</button>
                <button class="service-btn glitch-hover" id="stopServiceBtn" style="display: none;">ARR√äTER SON SERVICE</button>
                <button class="service-btn glitch-hover" id="noWorkBtn">Absent pour aujourd'hui</button>
                <div class="timer-display" id="serviceTimer">00:00:00</div>
            </div>
            <div class="sale-section">
                <h4 class="sale-title glitch" data-text="ENREGISTRER UNE VENTE">ENREGISTRER UNE VENTE</h4>
                <input type="text" id="vehicleSearch" class="sale-search" placeholder="V√©hicule vendu">
                <input type="text" id="clientName" class="sale-input" placeholder="Nom du client...">
                <button class="sale-btn glitch-hover" id="recordSaleBtn">ENREGISTRER LA VENTE</button>
            </div>
        </div>
    </div>
    <!-- --- NOUVELLE MODALE DOSSIER --- -->
    <div class="dossier-page" id="dossierPage">
        <div class="dossier-content">
            <div class="dossier-header">
                <h3 class="dossier-title glitch" data-text="DOSSIER EMPLOY√âS">DOSSIER EMPLOY√âS</h3>
                <button class="close-modal" id="closeDossierModal">&times;</button>
            </div>
            <div class="role-buttons">
                <button class="role-btn glitch-hover" data-role="PDG">PDG</button>
                <button class="role-btn glitch-hover" data-role="Co-PDG">Co-PDG</button>
                <button class="role-btn glitch-hover" data-role="Vendeur">Vendeur</button>
            </div>
            <div class="vendeurs-list" id="vendeursList">
                <h4 class="vendeurs-title glitch" data-text="LISTE DES VENDEURS">LISTE DES VENDEURS</h4>
                <div class="vendeurs-grid" id="vendeursGrid">
                    <!-- Dynamiquement rempli -->
                </div>
            </div>
            <div class="summary-section" id="summarySection" style="display:none;">
                <h4 class="summary-title glitch" id="summaryTitle">R√âCAPITULATIF</h4>
                <!-- S√©lecteur de semaine (visible uniquement pour le PDG) -->
                <div id="weekSelectorContainer" style="text-align: center; margin-bottom: 1.5rem; display: none;">
                    <label for="weekSelector" style="display: block; margin-bottom: 0.5rem; color: var(--neon-red); font-family: 'Orbitron', sans-serif;">SEMAINE :</label>
                    <select id="weekSelector" class="form-select" style="width: 220px; margin: 0 auto; display: block;"></select>
                </div>
                <div class="summary-grid">
                    <div class="summary-box">
                        <div class="summary-label">HEURES DE SERVICE</div>
                        <div class="summary-value" id="totalHeures">00h00min00s</div>
                    </div>
                    <div class="summary-box">
                        <div class="summary-label">VOITURES VENDUES</div>
                        <div class="summary-value" id="totalVentes">0</div>
                    </div>
                    <div class="summary-box" style="grid-column: 1 / -1;">
                        <div class="summary-label">SALAIRE ESTIM√â</div>
                        <div class="summary-value" id="salaryDisplay" style="font-size: 1.8rem; color: var(--neon-red); font-family: 'Orbitron', sans-serif;"></div>
                    </div>
                </div>
                <div class="sales-list">
                    <h5 class="sales-title">D√âTAILS DES VENTES</h5>
                    <div id="salesDetails">
                        <!-- Liste des ventes -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Header -->
    <header>
        <div class="header-container">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-car"></i>
                </div>
                <div class="logo-text glitch" data-text="AutoCar">AutoCar</div>
            </div>
            <button class="mobile-menu-btn" id="menuBtn">
                <i class="fas fa-bars"></i>
            </button>
            <nav>
                <ul class="nav-menu" id="navMenu">
                    <li><a href="#home" class="nav-link glitch-hover">ACCUEIL</a></li>
                    <li><a href="#categories" class="nav-link glitch-hover">CAT√âGORIES</a></li>
                    <li><a href="#vehicles" class="nav-link glitch-hover">V√âHICULES</a></li>
                    <li><a href="#" class="nav-link glitch-hover" id="serviceLink" style="display: none;">SERVICE</a></li>
                    <li><a href="#" class="nav-link glitch-hover" id="dossierLink" style="display: none;">DOSSIER</a></li>
                </ul>
            </nav>
        </div>
    </header>
    <!-- Hero Section -->
    <section class="hero" id="home">
        <div class="hero-content">
            <h1 class="glitch fade-in" data-text="Impact Life VEHICLES">Impact Life VEHICLES</h1>
            <p class="hero-subtitle fade-in">Syst√®me de v√©hicules premium pour serveurs GTA Roleplay. Interface glitch√©e, performance optimale, exp√©rience immersive garantie.</p>
            <div class="hero-stats fade-in">
                <div class="stat-item">
                    <div class="stat-number glitch" data-text="100+">100+</div>
                    <div class="stat-label">V√âHICULES</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number glitch" data-text="8">8</div>
                    <div class="stat-label">CAT√âGORIES</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number glitch" data-text="24/7">24/7</div>
                    <div class="stat-label">SUPPORT</div>
                </div>
            </div>
        </div>
    </section>
    <!-- Categories Section -->
    <section class="categories-section" id="categories">
        <div class="section-header">
            <h2 class="section-title glitch neon-text" data-text="CAT√âGORIES">CAT√âGORIES</h2>
        </div>
        <div class="categories-grid">
            <div class="category-card glitch-hover active" data-category="all">
                <div class="category-icon">
                    <i class="fas fa-th-large"></i>
                </div>
                <h3 class="category-title">TOUTES</h3>
                <p class="category-description">Afficher tous les v√©hicules disponibles dans notre collection premium.</p>
                <div class="category-count">34 V√âHICULES</div>
            </div>
            <div class="category-card glitch-hover" data-category="berline">
                <div class="category-icon">
                    <i class="fas fa-car-side"></i>
                </div>
                <h3 class="category-title">BERLINE</h3>
                <p class="category-description">√âl√©gance, confort et prestige pour vos d√©placements urbains et missions RP.</p>
                <div class="category-count">0 V√âHICULES</div>
            </div>
            <div class="category-card glitch-hover" data-category="compact">
                <div class="category-icon">
                    <i class="fas fa-car"></i>
                </div>
                <h3 class="category-title">COMPACT</h3>
                <p class="category-description">Agilit√©, √©conomie et maniabilit√© parfaite pour la ville et zones √©troites.</p>
                <div class="category-count">0 V√âHICULES</div>
            </div>
            <div class="category-card glitch-hover" data-category="suv">
                <div class="category-icon">
                    <i class="fas fa-truck-moving"></i>
                </div>
                <h3 class="category-title">SUV</h3>
                <p class="category-description">Espace, polyvalence et robustesse pour toute la famille et toutes les missions.</p>
                <div class="category-count">17 V√âHICULES</div>
            </div>
            <div class="category-card glitch-hover" data-category="sportive">
                <div class="category-icon">
                    <i class="fas fa-tachometer-alt"></i>
                </div>
                <h3 class="category-title">SPORTIVE</h3>
                <p class="category-description">Performance, adr√©naline et style pour amateurs de vitesse et sensations fortes.</p>
                <div class="category-count">0 V√âHICULES</div>
            </div>
            <div class="category-card glitch-hover" data-category="deux-roues">
                <div class="category-icon">
                    <i class="fas fa-motorcycle"></i>
                </div>
                <h3 class="category-title">DEUX ROUES</h3>
                <p class="category-description">Libert√©, agilit√© et maniabilit√© absolue pour traverser la ville √† toute vitesse.</p>
                <div class="category-count">9 V√âHICULES</div>
            </div>
            <div class="category-card glitch-hover" data-category="hypercar">
                <div class="category-icon">
                    <i class="fas fa-bolt"></i>
                </div>
                <h3 class="category-title">HYPERCAR</h3>
                <p class="category-description">Technologie de pointe, vitesse extr√™me et exclusivit√© pour joueurs VIP.</p>
                <div class="category-count">0 V√âHICULES</div>
            </div>
            <div class="category-card glitch-hover" data-category="tout-terrain">
                <div class="category-icon">
                    <i class="fas fa-mountain"></i>
                </div>
                <h3 class="category-title">TOUT-TERRAIN</h3>
                <p class="category-description">Aventure, robustesse et capacit√© tout-terrain pour explorer chaque recoin.</p>
                <div class="category-count">5 V√âHICULES</div>
            </div>
            <div class="category-card glitch-hover" data-category="special">
                <div class="category-icon">
                    <i class="fas fa-star"></i>
                </div>
                <h3 class="category-title">SP√âCIAL</h3>
                <p class="category-description">V√©hicules uniques, customis√©s ou exclusifs r√©serv√©s aux joueurs VIP.</p>
                <div class="category-count">0 V√âHICULES</div>
            </div>
        </div>
    </section>
    <!-- Vehicles Showcase -->
    <section class="vehicles-showcase" id="vehicles">
        <div class="vehicles-header">
            <h2 class="current-category glitch" data-text="TOUTES LES CAT√âGORIES">TOUTES LES CAT√âGORIES</h2>
        </div>
        <div class="vehicles-grid" id="vehiclesGrid">
            <!-- Les v√©hicules seront charg√©s ici dynamiquement depuis Supabase -->
        </div>
    </section>
    <!-- Add Vehicle Modal -->
    <div class="modal" id="addVehicleModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title glitch" data-text="AJOUTER UN V√âHICULE">AJOUTER UN V√âHICULE</h3>
                <button class="close-modal" id="closeModal">&times;</button>
            </div>
            <form id="addVehicleForm">
                <div class="form-group">
                    <label class="form-label glitch" data-text="NOM DU V√âHICULE">NOM DU V√âHICULE</label>
                    <input type="text" name="name" class="form-input" placeholder="EX: INFERNUS CLASSIC" required>
                </div>
                <div class="form-group">
                    <label class="form-label glitch" data-text="CAT√âGORIE">CAT√âGORIE</label>
                    <select name="category" class="form-select" required>
                        <option value="">S√âLECTIONNEZ UNE CAT√âGORIE</option>
                        <option value="berline">BERLINE</option>
                        <option value="compact">COMPACT</option>
                        <option value="suv">SUV</option>
                        <option value="sportive">SPORTIVE</option>
                        <option value="deux-roue">DEUX ROUES</option>
                        <option value="hypercar">HYPERCAR</option>
                        <option value="tout-terrain">TOUT-TERRAIN</option>
                        <option value="special">SP√âCIAL</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label glitch" data-text="PRIX ($)">PRIX ($)</label>
                    <input type="number" name="price" class="form-input" placeholder="EX: 180000" required>
                </div>
                <div class="form-group">
                    <label class="form-label glitch" data-text="VITESSE MAX (KM/H)">VITESSE MAX (KM/H)</label>
                    <input type="number" name="vmax" class="form-input" placeholder="EX: 220" required>
                </div>
                <div class="form-group">
                    <label class="form-label glitch" data-text="0-100 KM/H (S)">0-100 KM/H (S)</label>
                    <input type="number" name="acceleration" step="0.1" class="form-input" placeholder="EX: 3.2" required>
                </div>
                <div class="form-group">
                    <label class="form-label glitch" data-text="URL DE L'IMAGE">URL DE L'IMAGE</label>
                    <input type="url" name="imageUrl" class="form-input" placeholder="HTTPS://EXAMPLE.COM/IMAGE.JPG" value="https://placehold.co/500x240/0a0a0a/ff0040?text=NEW+VEHICLE" required>
                </div>
                <button type="submit" class="submit-btn glitch-hover">AJOUTER LE V√âHICULE</button>
            </form>
        </div>
    </div>
    <!-- Vehicle Details Modal -->
    <div class="details-modal" id="vehicleDetailsModal">
        <div class="details-content">
            <div class="details-header">
                <h3 class="details-title" id="detailsVehicleName">NOM DU V√âHICULE</h3>
                <button class="close-modal" id="closeDetailsModal">&times;</button>
            </div>
            <div class="details-image-container">
                <img src="" alt="" id="detailsVehicleImage" class="details-image">
            </div>
            <div class="details-info">
                <div class="detail-item">
                    <div class="detail-label">PRIX</div>
                    <div class="detail-value" id="detailsPrice">‚Ç¨0</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">CAT√âGORIE</div>
                    <div class="detail-value" id="detailsCategory">-</div>
                </div>
            </div>
            <div class="details-actions">
                <button class="action-btn btn-buy" id="detailsBuyBtn">ACHETER</button>
            </div>
        </div>
    </div>
    <!-- Footer -->
    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-column">
                <h3 class="glitch" data-text="NEON MOTORS">NEON MOTORS</h3>
                <p style="color: var(--text-secondary); line-height: 1.6; margin-bottom: 1.5rem; font-size: 0.95rem;">
                    Syst√®me premium de v√©hicules pour serveurs GTA Roleplay. Interface glitch√©e, performance optimale.
                </p>
                <div class="social-links">
                    <a href="https://discord.gg/CDFbZdE3Sm" class="social-link glitch-hover"><i class="fab fa-discord"></i></a>
                    <a href="#" class="social-link glitch-hover"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="social-link glitch-hover"><i class="fab fa-instagram"></i></a>
                    <a href="#" class="social-link glitch-hover"><i class="fab fa-youtube"></i></a>
                </div>
            </div>
            <div class="footer-column">
                <h3>LIENS UTILES</h3>
                <ul class="footer-links">
                    <li><a href="#" class="glitch-hover"><i class="fas fa-chevron-right"></i> CONDITIONS</a></li>
                    <li><a href="#" class="glitch-hover"><i class="fas fa-chevron-right"></i> CONFIDENTIALIT√â</a></li>
                    <li><a href="#" class="glitch-hover"><i class="fas fa-chevron-right"></i> SUPPORT</a></li>
                    <li><a href="#" class="glitch-hover"><i class="fas fa-chevron-right"></i> FAQ</a></li>
                    <li><a href="#" class="glitch-hover"><i class="fas fa-chevron-right"></i> GUIDE</a></li>
                    <li><a href="#" class="glitch-hover" id="adminLoginLink"><i class="fas fa-chevron-right"></i> ADMIN</a></li>
                </ul>
            </div>
        </div>
        <div class="copyright glitch" data-text="&copy; 2024 NEON MOTORS. TOUS DROITS R√âSERV√âS.">
            &copy; 2024 NEON MOTORS. TOUS DROITS R√âSERV√âS. CE SITE EST EXCLUSIVEMENT DESTIN√â √Ä L'USAGE GTA ROLEPLAY, Ceratins liens ne sont pas cliquable pour cette raison.
        </div>
    </footer>
    <script>
        // Matrix Rain Effect
        const SUPABASE_URL = 'https://iinysqbddaxyiwlymgnh.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlpbnlzcWJkZGF4eWl3bHltZ25oIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1OTMzMzE1MywiZXhwIjoyMDc0OTA5MTUzfQ.Xkm9kZl5exbQZzBPewQrGbtnlmmlK7CYp8WU_sX9a-w';
        const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
        let authenticatedUser = null;
        let userRole = null;
    
        // === UTILITAIRES SEMAINE ===
        function getWeekBounds(date) {
            const d = new Date(date);
            const day = d.getDay();
            const diffToMonday = day === 0 ? -6 : 1 - day;
            const monday = new Date(d);
            monday.setDate(d.getDate() + diffToMonday);
            monday.setHours(0, 0, 0, 0);
    
            const sunday = new Date(monday);
            sunday.setDate(monday.getDate() + 6);
            sunday.setHours(23, 59, 59, 999);
    
            return { monday, sunday };
        }
    
        function getWeekKey(date) {
            const d = new Date(date);
            const year = d.getFullYear();
            d.setHours(0, 0, 0, 0);
            d.setDate(d.getDate() + 4 - (d.getDay() || 7));
            const week = Math.ceil((((d - new Date(d.getFullYear(), 0, 1)) / 8.64e7) + 1) / 7);
            return `${year}-${String(week).padStart(2, '0')}`;
        }
    
        async function getWeeksFromData() {
            try {
                const { data: serviceDates, error: serviceErr } = await supabaseClient
                    .from('service')
                    .select('date');
    
                const { data: venteDates, error: venteErr } = await supabaseClient
                    .from('vente')
                    .select('date');
    
                if (serviceErr || venteErr) {
                    return getLast8WeeksFallback();
                }
    
                const allDates = [
                    ...(serviceDates || []).map(s => s.date),
                    ...(venteDates || []).map(v => v.date)
                ];
    
                if (allDates.length === 0) {
                    return getLast8WeeksFallback();
                }
    
                const weekSet = new Set();
                allDates.forEach(dateStr => {
                    let d;
                    if (dateStr.includes('T')) {
                        d = new Date(dateStr);
                    } else {
                        const parts = dateStr.split(' ')[0].split('/');
                        if (parts.length === 3) {
                            const [day, month, year] = parts;
                            d = new Date(`${year}-${month}-${day}`);
                        }
                    }
                    if (d && !isNaN(d.getTime())) {
                        weekSet.add(getWeekKey(d));
                    }
                });
    
                const weeks = Array.from(weekSet)
                    .map(key => {
                        const [year, weekNum] = key.split('-').map(Number);
                        const jan4 = new Date(year, 0, 4);
                        const mondayOfYear = new Date(jan4);
                        mondayOfYear.setDate(jan4.getDate() - (jan4.getDay() || 7) + 1);
                        const monday = new Date(mondayOfYear);
                        monday.setDate(mondayOfYear.getDate() + (weekNum - 1) * 7);
                        return { key, monday };
                    })
                    .sort((a, b) => b.monday - a.monday)
                    .slice(0, 12)
                    .map(({ key, monday }) => ({
                        key,
                        label: `Semaine du ${monday.toLocaleDateString('fr-FR')}`,
                        monday
                    }));
    
                return weeks.length > 0 ? weeks : getLast8WeeksFallback();
            } catch (err) {
                console.error("Erreur dans getWeeksFromData:", err);
                return getLast8WeeksFallback();
            }
        }
    
        function getLast8WeeksFallback() {
            const weeks = [];
            const now = new Date();
            for (let i = 0; i < 8; i++) {
                const date = new Date(now);
                date.setDate(now.getDate() - i * 7);
                const key = getWeekKey(date);
                const { monday } = getWeekBounds(date);
                const label = `Semaine du ${monday.toLocaleDateString('fr-FR')}`;
                if (!weeks.find(w => w.key === key)) {
                    weeks.push({ key, label, monday });
                }
            }
            return weeks.sort((a, b) => b.monday - a.monday);
        }
    
        const canvas = document.getElementById('matrix-rain');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        const matrix = "„Ç¢„Ç°„Ç´„Çµ„Çø„Éä„Éè„Éû„É§„É£„É©„ÉØ„Ç¨„Ç∂„ÉÄ„Éê„Éë„Ç§„Ç£„Ç≠„Ç∑„ÉÅ„Éã„Éí„Éü„É™„É∞„ÇÆ„Ç∏„ÉÇ„Éì„Éî„Ç¶„Ç•„ÇØ„Çπ„ÉÑ„Éå„Éï„É†„É¶„É•„É´„Ç∞„Ç∫„Éñ„ÉÖ„Éó„Ç®„Çß„Ç±„Çª„ÉÜ„Éç„Éò„É°„É¨„É±„Ç≤„Çº„Éá„Éô„Éö„Ç™„Ç©„Ç≥„ÇΩ„Éà„Éé„Éõ„É¢„É®„Éß„É≠„É≤„Ç¥„Çæ„Éâ„Éú„Éù„É¥„ÉÉ„É≥0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";
        const matrixArray = matrix.split("");
        const fontSize = 14;
        const columns = canvas.width / fontSize;
        const drops = [];
        for(let x = 0; x < columns; x++)
            drops[x] = 1;
        function draw() {
            ctx.fillStyle = "rgba(0, 0, 0, 0.04)";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = "#ff0040";
            ctx.font = fontSize + "px monospace";
            for(let i = 0; i < drops.length; i++) {
                const text = matrixArray[Math.floor(Math.random() * matrixArray.length)];
                ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                if(drops[i] * fontSize > canvas.height && Math.random() > 0.975)
                    drops[i] = 0;
                drops[i]++;
            }
        }
        setInterval(draw, 35);
    
        const menuBtn = document.getElementById('menuBtn');
        const navMenu = document.getElementById('navMenu');
        menuBtn.addEventListener('click', () => {
            navMenu.classList.toggle('show');
        });
    
        const categoryCards = document.querySelectorAll('.category-card');
        const vehiclesGrid = document.getElementById('vehiclesGrid');
        const currentCategoryElement = document.querySelector('.current-category');
        const vehicleCards = document.querySelectorAll('.vehicle-card');
        function filterVehicles(selectedCategory) {
            // Mettre √† jour l'UI des cat√©gories
            categoryCards.forEach(card => {
                if (card.getAttribute('data-category') === selectedCategory) {
                    card.classList.add('active');
                } else {
                    card.classList.remove('active');
                }
            });
        
            // D√©terminer le nom de la cat√©gorie affich√©e
            let categoryName = 'TOUTES LES CAT√âGORIES';
            if (selectedCategory !== 'all') {
                const activeCard = document.querySelector(`.category-card[data-category="${selectedCategory}"]`);
                if (activeCard) {
                    categoryName = activeCard.querySelector('.category-title').textContent;
                }
            }
            currentCategoryElement.textContent = categoryName;
            currentCategoryElement.setAttribute('data-text', categoryName);
        
            // Filtrer DYNAMIQUEMENT les v√©hicules (m√™me si charg√©s depuis DB)
            const allVehicleCards = vehiclesGrid.querySelectorAll('.vehicle-card');
            allVehicleCards.forEach(vehicle => {
                const vehicleCategory = vehicle.getAttribute('data-category');
                if (selectedCategory === 'all' || vehicleCategory === selectedCategory) {
                    vehicle.style.display = 'block';
                } else {
                    vehicle.style.display = 'none';
                }
            });
        
            // Scroll vers la section
            const vehiclesSection = document.getElementById('vehicles');
            if (vehiclesSection) {
                vehiclesSection.scrollIntoView({ behavior: 'smooth' });
            }
        }
        categoryCards.forEach(card => {
            card.addEventListener('click', () => {
                const selectedCategory = card.getAttribute('data-category');
                filterVehicles(selectedCategory);
            });
        });
        
        function updateCategoryCount(category) {
            const categoryCard = document.querySelector(`.category-card[data-category="${category}"]`);
            if (categoryCard) {
                const countElement = categoryCard.querySelector('.category-count');
                const currentCount = parseInt(countElement.textContent);
                countElement.textContent = `${currentCount + 1} V√âHICULES`;
            }
            const allCard = document.querySelector('.category-card[data-category="all"]');
            const allCountElement = allCard.querySelector('.category-count');
            const allCurrentCount = parseInt(allCountElement.textContent);
            allCountElement.textContent = `${allCurrentCount + 1} V√âHICULES`;
        }
        function showSuccessMessage(message) {
            const successDiv = document.createElement('div');
            successDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #00ff88;
                color: #000000;
                padding: 18px 30px;
                font-weight: bold;
                font-family: 'Orbitron', sans-serif;
                z-index: 3000;
                box-shadow: 0 0 30px rgba(0, 255, 136, 0.7);
                animation: slideIn 0.3s ease, fadeOut 0.5s ease 2.5s forwards;
                border: 2px solid #00ff88;
                letter-spacing: 2px;
                text-transform: uppercase;
                font-size: 1rem;
                border-radius: 10px;
            `;
            successDiv.textContent = message;
            document.body.appendChild(successDiv);
            setTimeout(() => {
                successDiv.remove();
            }, 3000);
        }
    
        const vehicleDetailsModal = document.getElementById('vehicleDetailsModal');
        const closeDetailsModal = document.getElementById('closeDetailsModal');
        const detailsVehicleName = document.getElementById('detailsVehicleName');
        const detailsVehicleImage = document.getElementById('detailsVehicleImage');
        const detailsPrice = document.getElementById('detailsPrice');
        const detailsVmax = document.getElementById('detailsVmax');
        const detailsAccel = document.getElementById('detailsAccel');
        const detailsCategory = document.getElementById('detailsCategory');
        const detailsBuyBtn = document.getElementById('detailsBuyBtn');
        function showVehicleDetails(button) {
            const vehicleCard = button.closest('.vehicle-card');
            const name = vehicleCard.getAttribute('data-name');
            const price = vehicleCard.getAttribute('data-price');
            const image = vehicleCard.getAttribute('data-image');
            const category = vehicleCard.getAttribute('data-category');

            // Mettre √† jour la modale
            detailsVehicleName.textContent = name;
            detailsVehicleImage.src = image;
            detailsVehicleImage.alt = name;
            detailsPrice.textContent = `${parseInt(price).toLocaleString()}‚Ç¨`;

            // Cat√©gorie lisible
            const categoryCard = document.querySelector(`.category-card[data-category="${category}"]`);
            detailsCategory.textContent = categoryCard 
                ? categoryCard.querySelector('.category-title').textContent 
                : category.toUpperCase();

            // ‚úÖ Afficher la modale
            vehicleDetailsModal.style.display = 'block';
        }
        closeDetailsModal.addEventListener('click', () => {
            vehicleDetailsModal.style.display = 'none';
        });
        window.addEventListener('click', (e) => {
            if (e.target === vehicleDetailsModal) {
                vehicleDetailsModal.style.display = 'none';
            }
        });
    
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    window.scrollTo({
                        top: target.offsetTop - 80,
                        behavior: 'smooth'
                    });
                    navMenu.classList.remove('show');
                }
            });
        });
    
        window.addEventListener('scroll', () => {
            const header = document.querySelector('header');
            if (window.scrollY > 50) {
                header.style.background = 'rgba(0, 0, 0, 0.98)';
                header.style.boxShadow = '0 5px 25px rgba(255, 0, 64, 0.4)';
            } else {
                header.style.background = 'rgba(0, 0, 0, 0.95)';
                header.style.boxShadow = 'none';
            }
        });
    
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
    
        const cartIcon = document.getElementById('cartIcon');
        const cartModal = document.getElementById('cartModal');
        const closeCartModal = document.getElementById('closeCartModal');
        const cartItems = document.getElementById('cartItems');
        const cartTotal = document.getElementById('cartTotal');
        const clearCartBtn = document.getElementById('clearCartBtn');
        const cartBadge = document.getElementById('cartBadge');
        const cartEmptyMessage = document.getElementById('cartEmptyMessage');
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        function updateCartBadge() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartBadge.textContent = totalItems;
        }
        function updateCartDisplay() {
            cartItems.innerHTML = '';
            let total = 0;
            if (cart.length === 0) {
                cartItems.appendChild(cartEmptyMessage);
                cartEmptyMessage.style.display = 'block';
                cartTotal.textContent = 'Total: 0‚Ç¨';
                updateCartBadge();
                return;
            } else {
                cartEmptyMessage.style.display = 'none';
            }
            cart.forEach((item, index) => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                const cartItemElement = document.createElement('div');
                cartItemElement.className = 'cart-item';
                cartItemElement.innerHTML = `
                    <div class="cart-item-info">
                        <div class="cart-item-name">${item.name}</div>
                        <div class="cart-item-price">${item.price.toLocaleString()}‚Ç¨</div>
                        <div class="cart-item-quantity">Quantit√©: ${item.quantity}</div>
                    </div>
                    <button class="cart-item-remove" onclick="removeFromCart(${index})">Supprimer</button>
                `;
                cartItems.appendChild(cartItemElement);
            });
            cartTotal.textContent = `Total: ${total.toLocaleString()}‚Ç¨`;
            updateCartBadge();
        }
        function addToCart(button) {
            const vehicleCard = button.closest('.vehicle-card');
            const name = vehicleCard.getAttribute('data-name');
            const price = parseInt(vehicleCard.getAttribute('data-price'));
            const existingItemIndex = cart.findIndex(item => item.name === name);
            if (existingItemIndex > -1) {
                cart[existingItemIndex].quantity += 1;
            } else {
                cart.push({ name: name, price: price, quantity: 1 });
            }
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartDisplay();
            showSuccessMessage('V√âHICULE AJOUT√â AU PANIER!');
        }
        function addToCartFromDetails() {
            const name = detailsVehicleName.textContent;
            const price = parseInt(detailsPrice.textContent.replace('‚Ç¨', '').replace(/\s/g, ''));
            const existingItemIndex = cart.findIndex(item => item.name === name);
            if (existingItemIndex > -1) {
                cart[existingItemIndex].quantity += 1;
            } else {
                cart.push({ name: name, price: price, quantity: 1 });
            }
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartDisplay();
            showSuccessMessage('V√âHICULE AJOUT√â AU PANIER!');
            vehicleDetailsModal.style.display = 'none';
        }
        function removeFromCart(index) {
            cart.splice(index, 1);
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartDisplay();
        }
        function clearCart() {
            cart = [];
            localStorage.removeItem('cart');
            updateCartDisplay();
        }
        cartIcon.addEventListener('click', () => {
            updateCartDisplay();
            cartModal.style.display = 'block';
        });
        closeCartModal.addEventListener('click', () => {
            cartModal.style.display = 'none';
        });
        window.addEventListener('click', (e) => {
            if (e.target === cartModal) {
                cartModal.style.display = 'none';
            }
        });
        clearCartBtn.addEventListener('click', clearCart);
        updateCartBadge();
    
        const adminLoginLink = document.getElementById('adminLoginLink');
        const loginModal = document.getElementById('loginModal');
        const closeLoginModal = document.getElementById('closeLoginModal');
        const loginForm = document.getElementById('loginForm');
        const servicePage = document.getElementById('servicePage');
        const closeServiceModal = document.getElementById('closeServiceModal');
        const serviceLink = document.getElementById('serviceLink');
        const dossierLink = document.getElementById('dossierLink');
        const startServiceBtn = document.getElementById('startServiceBtn');
        const stopServiceBtn = document.getElementById('stopServiceBtn');
        const noWorkBtn = document.getElementById('noWorkBtn');
        const serviceTimer = document.getElementById('serviceTimer');
        const recordSaleBtn = document.getElementById('recordSaleBtn');
        const vehicleSearch = document.getElementById('vehicleSearch');
        const clientName = document.getElementById('clientName');
        const pauseServiceBtn = document.getElementById('pauseServiceBtn');
        const resumeServiceBtn = document.getElementById('resumeServiceBtn');
    
        let serviceInterval = null;
        let serviceStartTime = null;
        let serviceActive = false;
        let servicePaused = false;
        let servicePausedAt = null;
        let totalPausedTime = 0;
    
        function saveServiceState() {
            localStorage.setItem('serviceState', JSON.stringify({
                serviceActive,
                serviceStartTime: serviceStartTime ? serviceStartTime.getTime() : null,
                servicePaused,
                servicePausedAt: servicePausedAt ? servicePausedAt.getTime() : null,
                totalPausedTime
            }));
        }
        function loadServiceState() {
            const state = JSON.parse(localStorage.getItem('serviceState'));
            if (state) {
                serviceActive = !!state.serviceActive;
                serviceStartTime = state.serviceStartTime ? new Date(state.serviceStartTime) : null;
                servicePaused = !!state.servicePaused;
                servicePausedAt = state.servicePausedAt ? new Date(state.servicePausedAt) : null;
                totalPausedTime = state.totalPausedTime || 0;
            }
        }
        function updateServiceTimerDisplay() {
            if (!serviceActive || !serviceStartTime) {
                serviceTimer.textContent = '00:00:00';
                return;
            }
            let elapsed;
            if (servicePaused && servicePausedAt) {
                elapsed = servicePausedAt - serviceStartTime - totalPausedTime;
            } else {
                elapsed = Date.now() - serviceStartTime.getTime() - totalPausedTime;
            }
            let hours = Math.floor(elapsed / (1000 * 60 * 60));
            let minutes = Math.floor((elapsed / (1000 * 60)) % 60);
            let seconds = Math.floor((elapsed / 1000) % 60);
            serviceTimer.textContent = `${String(hours).padStart(2,'0')}:${String(minutes).padStart(2,'0')}:${String(seconds).padStart(2,'0')}`;
        }
        function startServiceInterval() {
            if (serviceInterval) clearInterval(serviceInterval);
            serviceInterval = setInterval(updateServiceTimerDisplay, 1000);
        }
    
        adminLoginLink.addEventListener('click', (e) => {
            e.preventDefault();
            loginModal.style.display = 'block';
        });
        closeLoginModal.addEventListener('click', () => {
            loginModal.style.display = 'none';
        });
        loginForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            const username = document.getElementById('adminUsername').value.trim();
            const password = document.getElementById('adminPassword').value.trim();
            if (!username || !password) {
                alert("Veuillez entrer un nom d'utilisateur et un mot de passe.");
                return;
            }
            try {
                const { data, error } = await supabaseClient
                    .from('compte')
                    .select('*')
                    .eq('username', username)
                    .eq('password', password)
                    .single();
                if (error || !data) {
                    alert("Nom d'utilisateur ou mot de passe incorrect.");
                    return;
                }
                authenticatedUser = username;
                userRole = data.role;
                loginModal.style.display = 'none';
                loginForm.reset();
                serviceLink.style.display = 'block';
                if (userRole === 'PDG' || userRole === 'Co-PDG' || userRole === 'Admin') {
                    dossierLink.style.display = 'block';
                }
                showSuccessMessage('Connexion r√©ussie !');
            } catch (err) {
                alert("Erreur lors de la connexion.");
            }
        });
    
        window.addEventListener('click', (e) => {
            if (e.target === loginModal) loginModal.style.display = 'none';
            if (e.target === servicePage) servicePage.style.display = 'none';
            if (e.target === dossierPage) dossierPage.style.display = 'none';
        });
    
        serviceLink.addEventListener('click', (e) => {
            e.preventDefault();
            if (serviceLink.style.display !== 'none') {
                servicePage.style.display = 'block';
                updateServiceButtons();
                updateServiceTimerDisplay();
            }
        });
        closeServiceModal.addEventListener('click', () => {
            servicePage.style.display = 'none';
        });
    
        function updateServiceButtons() {
            if (!serviceActive) {
                startServiceBtn.style.display = 'block';
                stopServiceBtn.style.display = 'none';
                pauseServiceBtn.style.display = 'none';
                resumeServiceBtn.style.display = 'none';
            } else if (servicePaused) {
                startServiceBtn.style.display = 'none';
                stopServiceBtn.style.display = 'block';
                pauseServiceBtn.style.display = 'none';
                resumeServiceBtn.style.display = 'block';
            } else {
                startServiceBtn.style.display = 'none';
                stopServiceBtn.style.display = 'block';
                pauseServiceBtn.style.display = 'block';
                resumeServiceBtn.style.display = 'none';
            }
        }
    
        async function startService() {
            if (serviceActive) return;
            if (!authenticatedUser) {
                alert("Vous devez √™tre connect√©.");
                return;
            }
            serviceActive = true;
            serviceStartTime = new Date();
            servicePaused = false;
            servicePausedAt = null;
            totalPausedTime = 0;
            updateServiceButtons();
            updateServiceTimerDisplay();
            startServiceInterval();
            saveServiceState();
            try {
                const { data: lastEntry, error: fetchError } = await supabaseClient
                    .from('service')
                    .select('id_service')
                    .order('id_service', { ascending: false })
                    .limit(1);
                let newId = 1;
                if (lastEntry && lastEntry.length > 0) {
                    newId = lastEntry[0].id_service + 1;
                }
                const startDate = new Date().toISOString();
                const newServiceEntry = {
                    id_service: newId,
                    nom: authenticatedUser,
                    date: startDate,
                    temp: 0
                };
                const { error: insertError } = await supabaseClient
                    .from('service')
                    .insert([newServiceEntry]);
                if (insertError) {
                    alert("Erreur lors de l'enregistrement du service.");
                    stopService();
                } else {
                    localStorage.setItem('currentServiceId', newId);
                }
            } catch (err) {
                alert("Erreur inattendue.");
                stopService();
            }
        }
    
        function stopService() {
            if (!serviceActive) return;
            const currentServiceId = localStorage.getItem('currentServiceId');
            if (!currentServiceId) {
                serviceActive = false;
                servicePaused = false;
                servicePausedAt = null;
                totalPausedTime = 0;
                serviceStartTime = null;
                updateServiceButtons();
                updateServiceTimerDisplay();
                clearInterval(serviceInterval);
                saveServiceState();
                return;
            }
            let totalTimeMs;
            if (servicePaused && servicePausedAt) {
                totalTimeMs = servicePausedAt.getTime() - serviceStartTime.getTime() - totalPausedTime;
            } else {
                totalTimeMs = Date.now() - serviceStartTime.getTime() - totalPausedTime;
            }
            const totalSeconds = Math.floor(totalTimeMs / 1000);
            const hours = Math.floor(totalSeconds / 3600);
            const minutes = Math.floor((totalSeconds % 3600) / 60);
            const seconds = totalSeconds % 60;
            const formattedTemp = `${String(hours).padStart(2, '0')}h${String(minutes).padStart(2, '0')}min${String(seconds).padStart(2, '0')}s`;
            supabaseClient
                .from('service')
                .update({ date: new Date().toISOString(), temp: formattedTemp })
                .eq('id_service', parseInt(currentServiceId))
                .then(({ error }) => {
                    if (error) {
                        alert("Erreur lors de l'enregistrement de la fin.");
                    } else {
                        localStorage.removeItem('currentServiceId');
                    }
                });
            serviceActive = false;
            servicePaused = false;
            servicePausedAt = null;
            totalPausedTime = 0;
            serviceStartTime = null;
            updateServiceButtons();
            updateServiceTimerDisplay();
            clearInterval(serviceInterval);
            saveServiceState();
        }
    
        function pauseService() {
            if (!serviceActive || servicePaused) return;
            servicePaused = true;
            servicePausedAt = new Date();
            updateServiceButtons();
            updateServiceTimerDisplay();
            clearInterval(serviceInterval);
            saveServiceState();
        }
    
        function resumeService() {
            if (!serviceActive || !servicePaused) return;
            totalPausedTime += (new Date() - servicePausedAt);
            servicePaused = false;
            servicePausedAt = null;
            updateServiceButtons();
            updateServiceTimerDisplay();
            startServiceInterval();
            saveServiceState();
        }
    
        async function noWork() {
            if (serviceActive) await stopService();
            localStorage.removeItem('currentServiceId');
            alert('Statut "Absent" activ√©.');
        }
    
        async function recordSale() {
            const vehicle = vehicleSearch.value.trim();
            const client = clientName.value.trim();
            if (!vehicle || !client) {
                alert('Veuillez entrer un v√©hicule et un client.');
                return;
            }
            if (!authenticatedUser) {
                alert("Vous devez √™tre connect√©.");
                return;
            }
            try {
                const { data: lastSale, error: fetchError } = await supabaseClient
                    .from('vente')
                    .select('id_vente')
                    .order('id_vente', { ascending: false })
                    .limit(1);
                let newSaleId = 1;
                if (lastSale && lastSale.length > 0) {
                    newSaleId = lastSale[0].id_vente + 1;
                }
                const now = new Date();
                const formattedDate = now.toLocaleDateString('fr-FR', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric'
                }) + ' ' + now.toLocaleTimeString('fr-FR', {
                    hour: '2-digit',
                    minute: '2-digit'
                });
                const newSaleEntry = {
                    id_vente: newSaleId,
                    client: client,
                    vehicule: vehicle,
                    date: formattedDate,
                    username: authenticatedUser
                };
                const { error: saleError } = await supabaseClient
                    .from('vente')
                    .insert([newSaleEntry]);
                if (saleError) {
                    alert("Erreur lors de l'enregistrement de la vente.");
                    return;
                }
                const { data: lastClient, error: fetchClientError } = await supabaseClient
                    .from('client')
                    .select('id_client')
                    .order('id_client', { ascending: false })
                    .limit(1);
                let newClientId = 1;
                if (lastClient && lastClient.length > 0) {
                    newClientId = lastClient[0].id_client + 1;
                }
                const newClientEntry = {
                    id_client: newClientId,
                    client: client,
                    vehicule: vehicle,
                    date: formattedDate,
                    vendeur: authenticatedUser
                };
                const { error: clientError } = await supabaseClient
                    .from('client')
                    .insert([newClientEntry]);
                if (clientError) {
                    alert("Erreur lors de l'enregistrement du client.");
                }
                vehicleSearch.value = '';
                clientName.value = '';
                alert(`Vente enregistr√©e : ${vehicle} vendu √† ${client}.`);
            } catch (err) {
                alert("Erreur inattendue.");
            }
        }
    
        // --- DOSSIER EMPLOY√âS ---
        const dossierPage = document.getElementById('dossierPage');
        const closeDossierModal = document.getElementById('closeDossierModal');
        const vendeursList = document.getElementById('vendeursList');
        const vendeursGrid = document.getElementById('vendeursGrid');
        const summarySection = document.getElementById('summarySection');
        const summaryTitle = document.getElementById('summaryTitle');
        const totalHeures = document.getElementById('totalHeures');
        const totalVentes = document.getElementById('totalVentes');
        const salesDetails = document.getElementById('salesDetails');
        const salaryDisplay = document.getElementById('salaryDisplay');
    
        // S√©lecteur de semaine
        const weekSelectorContainer = document.getElementById('weekSelectorContainer');
        const weekSelector = document.getElementById('weekSelector');
    
        async function populateWeekSelector() {
            const weeks = await getWeeksFromData();
            weekSelector.innerHTML = '';
            weeks.forEach(w => {
                const opt = document.createElement('option');
                opt.value = w.key;
                opt.textContent = w.label;
                weekSelector.appendChild(opt);
            });
        }
    
        weekSelector.addEventListener('change', () => {
            const selectedRoleBtn = document.querySelector('.role-btn.active');
            const selectedVendeurBtn = document.querySelector('.vendeur-btn.active');
            const weekKey = weekSelector.value;
    
            if (selectedRoleBtn) {
                const role = selectedRoleBtn.getAttribute('data-role');
                loadRoleSummary(role, weekKey);
            } else if (selectedVendeurBtn) {
                const username = selectedVendeurBtn.textContent;
                loadEmployeeSummary(username, weekKey);
            }
        });
    
        dossierLink.addEventListener('click', (e) => {
            e.preventDefault();
            if (dossierLink.style.display !== 'none') {
                dossierPage.style.display = 'block';
                vendeursList.style.display = 'none';
                summarySection.style.display = 'none';
            }
        });
        closeDossierModal.addEventListener('click', () => {
            dossierPage.style.display = 'none';
        });
    
        document.querySelectorAll('.role-btn').forEach(btn => {
            btn.addEventListener('click', async () => {
                document.querySelectorAll('.role-btn, .vendeur-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
    
                const role = btn.getAttribute('data-role');

                if (userRole === 'PDG' || userRole === 'Co-PDG' || userRole === 'Admin') {
                    weekSelectorContainer.style.display = 'block';
                    populateWeekSelector();
                } else {
                    weekSelectorContainer.style.display = 'none';
                }
    
                if (role === 'Vendeur') {
                    try {
                        const { data, error } = await supabaseClient
                            .from('compte')
                            .select('username')
                            .eq('role', 'Vendeur');
                        if (error) throw error;
                        vendeursGrid.innerHTML = '';
                        data.forEach(user => {
                            const btnEl = document.createElement('button');
                            btnEl.className = 'vendeur-btn glitch-hover';
                            btnEl.textContent = user.username;
                            btnEl.onclick = () => {
                                document.querySelectorAll('.vendeur-btn').forEach(b => b.classList.remove('active'));
                                btnEl.classList.add('active');
                                loadEmployeeSummary(user.username, weekSelector.value || null);
                            };
                            vendeursGrid.appendChild(btnEl);
                        });
                        vendeursList.style.display = 'block';
                        summarySection.style.display = 'none';
                    } catch (err) {
                        alert("Erreur lors du chargement des vendeurs.");
                    }
                } else {
                    loadRoleSummary(role, weekSelector.value || null);
                }
            });
        });
    
        async function loadEmployeeSummary(username, weekKey = null) {
            try {
                const { data: user, error: userError } = await supabaseClient
                    .from('compte')
                    .select('role')
                    .eq('username', username)
                    .single();
                if (userError) throw userError;
                const role = user.role;
    
                const targetDate = weekKey ? new Date() : new Date();
                if (weekKey) {
                    const [year, weekNum] = weekKey.split('-').map(Number);
                    const jan4 = new Date(year, 0, 4);
                    const mondayOfYear = new Date(jan4);
                    mondayOfYear.setDate(jan4.getDate() - (jan4.getDay() || 7) + 1);
                    const targetMonday = new Date(mondayOfYear);
                    targetMonday.setDate(mondayOfYear.getDate() + (weekNum - 1) * 7);
                    targetDate.setTime(targetMonday.getTime());
                }
    
                const { monday, sunday } = getWeekBounds(targetDate);
    
                const { data: services, error: serviceError } = await supabaseClient
                    .from('service')
                    .select('temp, date')
                    .eq('nom', username)
                    .gte('date', monday.toISOString())
                    .lte('date', sunday.toISOString());
                if (serviceError) throw serviceError;
    
                const { data: allVentes, error: venteError } = await supabaseClient
                    .from('vente')
                    .select('id_vente, vehicule, date')
                    .eq('username', username);
                if (venteError) throw venteError;
    
                const ventes = allVentes.filter(v => {
                    const dateStr = v.date.split(' ')[0];
                    const [day, month, year] = dateStr.split('/');
                    const saleDate = new Date(`${year}-${month}-${day}`);
                    return saleDate >= monday && saleDate <= sunday;
                });
    
                let totalSec = 0;
                services.forEach(s => {
                    if (s.temp) {
                        const parts = s.temp.match(/(\d+)h(\d+)min(\d+)s/);
                        if (parts) {
                            totalSec += parseInt(parts[1]) * 3600 + parseInt(parts[2]) * 60 + parseInt(parts[3]);
                        }
                    }
                });
    
                const h = Math.floor(totalSec / 3600);
                const m = Math.floor((totalSec % 3600) / 60);
                const s = totalSec % 60;
                totalHeures.textContent = `${String(h).padStart(2, '0')}h${String(m).padStart(2, '0')}min${String(s).padStart(2, '0')}s`;
                const nbVentes = ventes.length;
                totalVentes.textContent = nbVentes;
    
                salesDetails.innerHTML = '';
                ventes.forEach(v => {
                    const div = document.createElement('div');
                    div.className = 'sale-item';
                    div.textContent = `${v.date} - ${v.vehicule}`;
                    salesDetails.appendChild(div);
                });
    
                summaryTitle.textContent = `R√âCAPITULATIF ${username} (${monday.toLocaleDateString('fr-FR')} au ${sunday.toLocaleDateString('fr-FR')})`;
                summarySection.style.display = 'block';
    
                const tauxHoraire = role === 'PDG' ? 1500 : (role === 'Co-PDG' ? 1200 : 1000);
                const heuresTotales = totalSec / 3600;
                const salaireHoraire = heuresTotales * tauxHoraire;
                const primeVentes = nbVentes * 300;
                const salaireTotal = Math.round(salaireHoraire + primeVentes);
                salaryDisplay.textContent = `${salaireTotal.toLocaleString()}‚Ç¨`;
            } catch (err) {
                console.error("Erreur dans loadEmployeeSummary:", err);
                alert("Erreur lors du chargement des donn√©es.");
            }
        }
    
        async function loadRoleSummary(role, weekKey = null) {
            try {
                const { data: users, error: userError } = await supabaseClient
                    .from('compte')
                    .select('username')
                    .eq('role', role);
                if (userError) throw userError;
                const usernames = users.map(u => u.username);
    
                const targetDate = weekKey ? new Date() : new Date();
                if (weekKey) {
                    const [year, weekNum] = weekKey.split('-').map(Number);
                    const jan4 = new Date(year, 0, 4);
                    const mondayOfYear = new Date(jan4);
                    mondayOfYear.setDate(jan4.getDate() - (jan4.getDay() || 7) + 1);
                    const targetMonday = new Date(mondayOfYear);
                    targetMonday.setDate(mondayOfYear.getDate() + (weekNum - 1) * 7);
                    targetDate.setTime(targetMonday.getTime());
                }
    
                const { monday, sunday } = getWeekBounds(targetDate);
    
                const { data: services, error: serviceError } = await supabaseClient
                    .from('service')
                    .select('temp, date')
                    .in('nom', usernames)
                    .gte('date', monday.toISOString())
                    .lte('date', sunday.toISOString());
                if (serviceError) throw serviceError;
    
                const { data: allVentes, error: venteError } = await supabaseClient
                    .from('vente')
                    .select('id_vente, vehicule, date')
                    .in('username', usernames);
                if (venteError) throw venteError;
    
                const ventes = allVentes.filter(v => {
                    const dateStr = v.date.split(' ')[0];
                    const [day, month, year] = dateStr.split('/');
                    const saleDate = new Date(`${year}-${month}-${day}`);
                    return saleDate >= monday && saleDate <= sunday;
                });
    
                let totalSec = 0;
                services.forEach(s => {
                    if (s.temp) {
                        const parts = s.temp.match(/(\d+)h(\d+)min(\d+)s/);
                        if (parts) {
                            totalSec += parseInt(parts[1]) * 3600 + parseInt(parts[2]) * 60 + parseInt(parts[3]);
                        }
                    }
                });
    
                const h = Math.floor(totalSec / 3600);
                const m = Math.floor((totalSec % 3600) / 60);
                const s = totalSec % 60;
                totalHeures.textContent = `${String(h).padStart(2, '0')}h${String(m).padStart(2, '0')}min${String(s).padStart(2, '0')}s`;
                const nbVentes = ventes.length;
                totalVentes.textContent = nbVentes;
    
                salesDetails.innerHTML = '';
                ventes.forEach(v => {
                    const div = document.createElement('div');
                    div.className = 'sale-item';
                    div.textContent = `${v.date} - ${v.vehicule}`;
                    salesDetails.appendChild(div);
                });
    
                summaryTitle.textContent = `R√âCAPITULATIF ${role.toUpperCase()} (${monday.toLocaleDateString('fr-FR')} au ${sunday.toLocaleDateString('fr-FR')})`;
                summarySection.style.display = 'block';
                vendeursList.style.display = 'none';
    
                const tauxHoraire = role === 'PDG' ? 1500 : (role === 'Co-PDG' ? 1200 : 1000);
                const heuresTotales = totalSec / 3600;
                const salaireHoraire = heuresTotales * tauxHoraire;
                const primeVentes = nbVentes * 300;
                const salaireTotal = Math.round(salaireHoraire + primeVentes);
                salaryDisplay.textContent = `${salaireTotal.toLocaleString()}‚Ç¨`;
            } catch (err) {
                console.error("Erreur dans loadRoleSummary:", err);
                alert("Erreur lors du chargement des donn√©es.");
            }
        }


        // Charger les v√©hicules depuis la table 'vehicule' dans Supabase
        async function loadVehiclesFromDB() {
            try {
                const { data: vehicles, error } = await supabaseClient
                    .from('vehicule')
                    .select('*')
                    .order('id', { ascending: true });
        
                if (error) throw error;
        
                // Effacer le grid existant
                vehiclesGrid.innerHTML = '';
        
                // Compteur par cat√©gorie (initialis√© √† 0)
                const categoryCounts = {
                    'all': 0,
                    'berline': 0,
                    'compact': 0,
                    'suv': 0,
                    'sportive': 0,
                    'deux-roues': 0,
                    'hypercar': 0,
                    'tout-terrain': 0,
                    'special': 0
                };
        
                // Liste des cat√©gories valides
                const validCategories = Object.keys(categoryCounts);
        
                vehicles.forEach(v => {
                    // Normaliser la cat√©gorie
                    let rawCat = (v.categorie || '').toLowerCase().trim();
                    // Mapping manuel pour g√©rer les variantes
                    const categoryMap = {
                        'deux roues': 'deux-roues',
                        'deux-roues': 'deux-roues',
                        'tout terrain': 'tout-terrain',
                        'tout-terrains': 'tout-terrain',
                        'berline': 'berline',
                        'compact': 'compact',
                        'suv': 'suv',
                        'sportive': 'sportive',
                        'hypercar': 'hypercar',
                        'special': 'special'
                    };
        
                    // Utiliser la cat√©gorie telle quelle, en minuscules, et valider
                    let safeCat = (v.categorie || '').toLowerCase().trim();
                    if (!validCategories.includes(safeCat)) {
                        safeCat = 'special';
                    }
        
                    // Incr√©menter les compteurs
                    categoryCounts['all']++;
                    categoryCounts[safeCat] = (categoryCounts[safeCat] || 0) + 1;
        
                    // URL de l'image (fallback si manquante)
                    const imageUrl = v.lien || 'https://placehold.co/500x240/0a0a0a/ff0040?text=NO+IMAGE';
        
                    // Cr√©er la carte
                    const card = document.createElement('div');
                    card.className = 'vehicle-card glitch-hover';
                    card.setAttribute('data-category', safeCat);
                    card.setAttribute('data-name', v.nom || 'V√©hicule sans nom');
                    card.setAttribute('data-price', v.prix || 0);
                    card.setAttribute('data-vmax', v.vmax || 0);
                    card.setAttribute('data-accel', v.speed || 0);
                    card.setAttribute('data-image', imageUrl);

                    // ‚úÖ Supprime les specs si tu ne veux pas les afficher sur la page principale
                    card.innerHTML = `
                        <div class="vehicle-image-container">
                            <img src="${imageUrl}" alt="${v.nom || 'V√©hicule'}" class="vehicle-image">
                        </div>
                        <div class="vehicle-info">
                            <h3 class="vehicle-name glitch" data-text="${(v.nom || '').toUpperCase()}">${v.nom || 'V√©hicule'}</h3>
                            <div class="vehicle-price">${parseInt(v.prix).toLocaleString()}‚Ç¨</div>
                            <div class="vehicle-actions">
                                <button class="action-btn btn-buy glitch-hover">ACHETER</button>
                                <button class="action-btn btn-details glitch-hover">D√âTAILS</button>
                            </div>
                        </div>
                    `;

                    // ‚úÖ Attacher les √©couteurs APR√àS avoir inject√© le HTML
                    const buyBtn = card.querySelector('.btn-buy');
                    const detailsBtn = card.querySelector('.btn-details');

                    buyBtn.addEventListener('click', function () {
                        addToCart(this);
                        alert(`‚úÖ V√âHICULE "${v.nom}" AJOUT√â √Ä VOTRE GARAGE!`);
                    });

                    detailsBtn.addEventListener('click', function () {
                        showVehicleDetails(this); // ‚Üê cette fonction DOIT exister
                    });

                    vehiclesGrid.appendChild(card);
        
                    card.addEventListener('mouseenter', () => {
                        card.style.animation = 'none';
                        setTimeout(() => card.style.animation = 'glitch-hover 0.3s', 10);
                    });
        
                    vehiclesGrid.appendChild(card);
                });
        
                // Mettre √† jour les compteurs dans l'UI
                Object.keys(categoryCounts).forEach(cat => {
                    const card = document.querySelector(`.category-card[data-category="${cat}"]`);
                    if (card) {
                        const countEl = card.querySelector('.category-count');
                        if (countEl) {
                            countEl.textContent = `${categoryCounts[cat]} V√âHICULES`;
                        }
                    }
                });
        
            } catch (err) {
                console.error("Erreur lors du chargement des v√©hicules depuis la base de donn√©es:", err);
                alert("Impossible de charger les v√©hicules. V√©rifiez votre connexion ou la structure de la table 'vehicule'.");
            }
        }
    
        // Charger les v√©hicules depuis la base au d√©marrage
        document.addEventListener('DOMContentLoaded', () => {
            loadVehiclesFromDB(); // ‚Üê Chargement dynamique

            // Scroll animation
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, { threshold: 0.1 });
            document.querySelectorAll('.fade-in').forEach(el => {
                observer.observe(el);
            });
        });
            
        startServiceBtn.addEventListener('click', startService);
        stopServiceBtn.addEventListener('click', stopService);
        pauseServiceBtn.addEventListener('click', pauseService);
        resumeServiceBtn.addEventListener('click', resumeService);
        noWorkBtn.addEventListener('click', noWork);
        recordSaleBtn.addEventListener('click', recordSale);
    
        loadServiceState();
        if (serviceActive && !authenticatedUser) {
            serviceActive = false;
            servicePaused = false;
            servicePausedAt = null;
            totalPausedTime = 0;
            serviceStartTime = null;
            localStorage.removeItem('currentServiceId');
            updateServiceButtons();
            updateServiceTimerDisplay();
        }
        if (serviceActive) {
            updateServiceButtons();
            updateServiceTimerDisplay();
            if (!servicePaused) {
                startServiceInterval();
            }
        }
        window.addEventListener('beforeunload', saveServiceState);
    </script>
</body>
</html>
